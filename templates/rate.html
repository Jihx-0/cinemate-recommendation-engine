{% extends "base.html" %}

{% block title %}Rate Movies - Lumora{% endblock %}

{% block content %}
<div class="rate-section">
    <div class="container">
        <h1 class="page-title">Rate Movies</h1>
        <p class="page-description">
            Rate the movies below to help us understand your taste. Our AI will use these ratings 
            to provide personalized recommendations just for you.
        </p>
        
        <form method="POST" action="{{ url_for('recommendations') }}">
            <div class="movies-grid">
                {% for movie in movies %}
                <div class="movie-rating-card">
                    <div class="movie-info">
                        {% if movie.poster_url %}
                        <img src="{{ movie.poster_url }}" alt="{{ movie.title }}" class="movie-poster poster-image">
                        {% else %}
                        <div class="movie-poster">
                            <i class="fas fa-film"></i>
                        </div>
                        {% endif %}
                        <div class="movie-details">
                            <h3 class="movie-title">{{ movie.title }}</h3>
                            {% if movie.genre %}
                            <p class="movie-genre">{{ movie.genre }}</p>
                            {% endif %}
                            {% if movie.vote_average %}
                            <div class="movie-rating-info">
                                <i class="fas fa-star"></i>
                                <span>{{ "%.1f"|format(movie.vote_average) }}</span>
                            </div>
                            {% endif %}
                            {% if movie.release_date %}
                            <div class="movie-year-info">{{ movie.release_date[:4] }}</div>
                            {% endif %}
                            {% if movie.overview %}
                            <p class="movie-overview">{{ movie.overview }}</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="rating-section">
                        <label class="rating-label">Rate this movie:</label>
                        <div class="star-rating">
                            <input type="radio" name="rating_{{ movie.movie_id }}" value="5" id="star5_{{ movie.movie_id }}" class="star-input">
                            <label for="star5_{{ movie.movie_id }}" class="star-label">★</label>
                            <input type="radio" name="rating_{{ movie.movie_id }}" value="4" id="star4_{{ movie.movie_id }}" class="star-input">
                            <label for="star4_{{ movie.movie_id }}" class="star-label">★</label>
                            <input type="radio" name="rating_{{ movie.movie_id }}" value="3" id="star3_{{ movie.movie_id }}" class="star-input">
                            <label for="star3_{{ movie.movie_id }}" class="star-label">★</label>
                            <input type="radio" name="rating_{{ movie.movie_id }}" value="2" id="star2_{{ movie.movie_id }}" class="star-input">
                            <label for="star2_{{ movie.movie_id }}" class="star-label">★</label>
                            <input type="radio" name="rating_{{ movie.movie_id }}" value="1" id="star1_{{ movie.movie_id }}" class="star-input">
                            <label for="star1_{{ movie.movie_id }}" class="star-label">★</label>
                        </div>
                        <div class="rating-text">
                            <span class="rating-value">Not rated</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-large">
                    <i class="fas fa-lightbulb"></i>
                    Get Recommendations
                </button>
                <a href="{{ url_for('home') }}" class="btn btn-outline btn-large">
                    <i class="fas fa-home"></i>
                    Back to Home
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Star rating functionality
    const starInputs = document.querySelectorAll('.star-input');
    
    starInputs.forEach(input => {
        input.addEventListener('change', function() {
            const movieId = this.name.replace('rating_', '');
            const rating = parseInt(this.value);
            const ratingText = this.closest('.rating-section').querySelector('.rating-value');
            
            if (rating === 0) {
                ratingText.textContent = 'Not rated';
                ratingText.className = 'rating-value not-rated';
            } else {
                ratingText.textContent = `${rating}/5 stars`;
                ratingText.className = 'rating-value rated';
            }
        });
    });
});
</script>
{% endblock %} 